<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="styles.css">
    <script src="jsfretboard.js" defer></script><script>
        function toggleFormulario() {
            const formulario = document.getElementById('formulario');
            if (formulario.style.display === 'none') {
                formulario.style.display = 'block';
            } else {
                formulario.style.display = 'none';
            }
        }
          function updateGridLayout() {
            const cols = document.getElementById('txt-grid-cols').value;
            const container = document.getElementById('canvas-container');
            
            console.log('Updating grid to', cols, 'columns');
            container.style.gridTemplateColumns = 'repeat(' + cols + ', 1fr)';
            
            // Also call the jsfretboard.js function if it exists
            if (typeof window.updateGridLayout !== 'undefined' && window.updateGridLayout !== updateGridLayout) {
                window.updateGridLayout();
            }
        }        function updateCustomScaleIndicator() {
            const customFormulaInput = document.getElementById('txt-formula');
            const scalesSection = document.getElementById('scales-section');
            
            if (customFormulaInput && scalesSection) {
                const hasCustomFormula = customFormulaInput.value.trim().length > 0;
                
                if (hasCustomFormula) {
                    customFormulaInput.classList.add('custom-active');
                    scalesSection.classList.add('overridden');
                } else {
                    customFormulaInput.classList.remove('custom-active');
                    scalesSection.classList.remove('overridden');
                }
            }
        }

        function clearCustomFormula() {
            const customFormulaInput = document.getElementById('txt-formula');
            if (customFormulaInput) {
                customFormulaInput.value = '';
                updateCustomScaleIndicator();
                
                // Trigger the generate function if it exists
                if (typeof generate === 'function') {
                    generate();
                }
                
                // Update save data if the function exists
                if (typeof all_fretboards !== 'undefined') {
                    const saveItem = document.getElementById("data-save");
                    if (saveItem) {
                        saveItem.value = JSON.stringify(all_fretboards);
                    }
                }
            }
        }

        // Set up the custom scale indicator when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            const customFormulaInput = document.getElementById('txt-formula');
            if (customFormulaInput) {
                // Check on input change
                customFormulaInput.addEventListener('input', updateCustomScaleIndicator);
                customFormulaInput.addEventListener('keyup', updateCustomScaleIndicator);
                customFormulaInput.addEventListener('change', updateCustomScaleIndicator);
                
                // Initial check
                updateCustomScaleIndicator();
            }
        });
    </script>
</head>
<body>    <div class="header">
        <h1>JSFretboards</h1>
                <button type="button" class="toggle-btn" onclick="toggleFormulario()">Toggle Form</button>
    </div>

    <div class="main-container">        <div id="formulario" class="form-panel">
            <div class="form-section">
                <h3>Fretboard Management</h3>
                <div class="button-group">
                    <button type="button" class="btn-icon" id="btn-addcanvas" onclick="addCanvas()">+</button>
                    <button type="button" class="btn-icon" id="btn-rmcanvas" onclick="rmCanvas()">-</button>
                </div>
                <div class="form-group">
                    <label for="fretboard-select">Select Fretboard</label>
                    <div id="fretboards-dropdown-group">
                    </div>
                </div>
            </div>

            <div class="form-section scales-section" id="scales-section">
                <h3>Scales</h3>
                <div id="scales-container">
                </div>
            </div>            <div class="form-section">
                <h3>Custom Scale</h3>
                <div class="form-group">
                    <label for="txt-formula">Custom formula</label>
                    <div class="input-button-group">
                        <input type="text" name="txt-formula" placeholder="1 2 b3 4 5 b6 b7" id="txt-formula"/>
                        <button type="button" class="btn-clear" id="btn-clear-formula" onclick="clearCustomFormula()">Clear</button>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>Display Options</h3>
                <div class="form-group">
                    <label for="select-rendertype">Render type</label>
                    <select name="select-rendertype" id="select-rendertype">
                        <option value="note">Note name</option>
                        <option value="interval">Interval value</option>
                        <option value="interval_name">Interval name</option>
                    </select>
                </div>
            </div>            <div class="form-section">
                <h3>Fretboard Settings</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="txt-starting-fret">Fret start</label>
                        <input type="text" id="txt-starting-fret" value="0" />
                    </div>
                    <div class="form-group">
                        <label for="txt-num-frets">Fret num</label>
                        <input type="text" id="txt-num-frets" value="24" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="txt-canvas-width">Canvas width</label>
                    <input type="text" id="txt-canvas-width" value="850" />
                </div>
            </div>            <div class="form-section">
                <h3>Layout</h3>
                <div class="form-group">
                    <label for="txt-grid-cols">Grid Columns</label>
                    <input type="text" id="txt-grid-cols" value="2" />
                </div>
            </div><div class="form-section">
                <h3>Data Management</h3>
                <div class="form-group">
                    <label for="data-load">Load Data</label>
                    <div class="input-button-group">
                        <input type="text" id="data-load"/>
                        <button type="button" class="btn-primary" onclick="loadData()">Load</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="data-save">Save Data</label>
                    <input type="text" id="data-save"/>
                </div>
            </div>

        </div>        <div id="canvas-container" class="canvas-panel">
            <!--<canvas id="fretcanvas0" width="850" height="270"></canvas>-->
        </div>

    </div>

</body>
</html>
